## MySQL基准测试

基准测试是针对系统设计的一种压力测试，通常目的是为了掌握系统的行为，但也有其他行为，如重现某个系统状态，或者是做新硬件的可靠性测试。

#### 1、为什么需要基准测试

- 基准测试是唯一方便有效的、可以学习系统在给定的工作负载下会发生什么的方法。
- 基准测试可以观察系统在不同压力下的行为，评估系统的容量，掌握哪些是重要的变化，或者观察系统如何处理不同的数据。
- 可以在系统实际负载之外创造一些虚构场景进行测试。

基准测试可以完成以下工作：

- **验证基于系统的一些假设，确认这些假设是否符合实际情况。**
- **重现系统中的某些异常行为，以解决这些异常。**
- **测试系统当前的运行情况**，如果不清楚系统当前的性能，就无法确认某些优化的效果如何。也可以利用历史的基准测试结果来分析诊断一些无法预测的问题。
- **模拟比当前系统更高的负载，以找出系统随着压力增加而可能遇到的扩展性瓶颈。**
- **规划未来的业务增长**，基准测试可以评估在项目未来的负载下，需要什么样的硬件，需要多大容量的网络，以及其他相关资源。这有助于降低系统升级和重大变更的风险。
- **测试应用适应可变环境的能力**。例如：通过基准测试，可以发现系统在随机的并发峰值下的性能表现，或者是不同配置的服务器之间的性能表现。基准测试也可以测试系统对不同数据分布的处理能力。
- **测试不同的硬件、软件和操作系统配置**。比如RAID5还是RAID10更适合当前的系统？如果系统从ATA硬盘升级到SAN存储，对于随机写性能有什么帮助？Linux2.4系列的内核会比2.6系列的可扩展性更好吗？升级MySQL的版本能改善性能吗？为当前的数据采用不同的存储引擎会有什么效果？所有的这类问题都可以通过专门的基准测试来获得答案。
- **证明新采购的设备是否配置正确**。永远不要相信主机提供商或者硬件供应商的所谓的系统已经安装好，并且能运行多块的说法。

基准测试的一个主要问题在于其不是真实压力的测试。其施加的压力相对真实压力来说，比较简单，真实压力是不可预期而且变化多端的。

#### 2、基准测试的策略

① 针对整个系统的整体测试（集成式）

② 单独测试MySQL（单组件式）

针对整个系统做集成式测试，而不是单独测试MySQL的原因有以下几点：

- 测试整个应用系统，包括Web服务器、应用代码、网络和数据库是非常有用的，以为用户关注的并不仅仅是MySQL本身的性能，而是应用整体的性能。
- MySQL并非总是应用的瓶颈，通过整体的测试可以揭示这一点。
- 只有对应用做整体测试，才能发现各部分之间的缓存带来的影响。
- 整体应用的集成式测试更能揭示应用的真实表现，而单独组件的测试很难做到这一点

有时候只需要关注MySQL的性能，至少在项目初期可以这样做，只测试MySQL:

- 需要比较不同的schema或查询的性能。
- 针对应用中的某个具体问题的测试。
- 为了避免漫长的基准测试，可以通过一个短期的基准测试，做快速的“周期循环”，来检测出某些调整后的效果。